@model PhongNguyenPuppy_MVC.Areas.Admin.ViewModels.DanhSachKhachHangVM
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    Layout = "_LayoutAdmin";
    ViewBag.Title = "Danh sách khách hàng";
}
@if (TempData["ThongBao"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>@TempData["ThongBao"]</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<h2>📋 Danh sách khách hàng</h2>

<!--  Tìm kiếm -->
<form method="get" asp-action="DanhSach" class="mb-3">
    <div class="input-group">
        <input type="text" name="TuKhoa" value="@Model.TuKhoa" class="form-control" placeholder="Tìm theo tên hoặc email..." />
        <button type="submit" class="btn btn-primary">🔍 Tìm</button>
    </div>
</form>

<!--  Bảng danh sách -->
<table class="table table-bordered table-striped">
    <thead class="bg-warning-custom text-dark">
        <tr>
            <th>Mã KH</th>
            <th>Họ tên</th>
            <th>Email</th>
            <th>Điện thoại</th>
            <th>Trạng thái</th>
            <th>Thao tác</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var kh in Model.DanhSach)
        {
            <tr>
                <td>@kh.MaKh</td>
                <td>@kh.HoTen</td>
                <td>@kh.Email</td>
                <td>@kh.DienThoai</td>
                <td>
                    <span class="@(kh.TrangThai ? "text-success" : "text-danger")">
                        @(kh.TrangThai ? "Hoạt động" : "Bị khóa")
                    </span>
                </td>
                <td>
                    <a asp-area="Admin" asp-controller="KhachHang" asp-action="ChiTiet" asp-route-id="@kh.MaKh" class="btn btn-sm btn-info">🔍 Xem</a>
                    <a asp-action="Xoa" asp-route-id="@kh.MaKh" class="btn btn-sm btn-danger" onclick="return confirm('Bạn có chắc muốn xóa?')">🗑️ Xóa</a>
                </td>
            </tr>
        }
    </tbody>
</table>

<!--  Phân trang -->
@if (Model.TongSoTrang > 1)
{
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            @for (int i = 1; i <= Model.TongSoTrang; i++)
            {
                <li class="page-item @(i == Model.TrangHienTai ? "active" : "")">
                    <a class="page-link" asp-action="DanhSach"
                       asp-route-TuKhoa="@Model.TuKhoa"
                       asp-route-trang="@i">
                        @i
                    </a>
                </li>
            }
        </ul>
    </nav>
}
